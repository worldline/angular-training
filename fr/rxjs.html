<!DOCTYPE html>
<html lang="fr-FR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.60">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="logo.png"><meta name="theme-color" content="#8514F5"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><title>RxJS | Formation Angular</title><meta name="description" content="Support de formation Angular">
    <link rel="stylesheet" href="/angular-training/assets/css/styles.d4c6a8a0.css">
    <link rel="preload" href="/angular-training/assets/js/runtime~app.a825557b.js" as="script"><link rel="preload" href="/angular-training/assets/css/styles.d4c6a8a0.css" as="style"><link rel="preload" href="/angular-training/assets/js/966.6bc1d20f.js" as="script"><link rel="preload" href="/angular-training/assets/js/app.2146f142.js" as="script"><link rel="preload" href="/angular-training/assets/js/v-7ba3cfc0.c87d4cf7.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-47a172f9.291bf16d.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-406818d6.121aa16d.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-7c58cd95.88b1841b.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-335946b2.0a9b9405.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-43e14fc6.215e05d9.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-0b5ef6ea.c8cafacc.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-06867140.fc4ed588.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-41615831.c02b75ba.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-0f3c5d64.2f8c6ae0.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-04259cc7.31930dc5.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-56a51099.e44197e4.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-66e9a7bd.d030d97c.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-76b3265c.57617f1a.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-dcd2f7ce.4327d6ae.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-4de770d4.688623d8.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-9f781948.3185612a.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-409dd4d7.206b4a5f.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-2f91e384.08bd7d0b.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-4a251b7e.f39af1e0.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-40885816.ed77776b.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-5753ab72.67971a99.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-7d1f12dc.2220acb2.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-a7994716.0eac4074.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-00a299a3.bc486f42.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-29b14426.ecbd918e.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-2d0a8b4a.e5989778.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-8daa1a0e.642f4708.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/783.d3c36333.js" as="script"><link rel="prefetch" href="/angular-training/assets/js/v-3706649a.39bfcd51.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/angular-training/fr/" class=""><!----><span class="site-name can-hide">Formation Angular</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Langue</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Langue</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/angular-training/" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/angular-training/fr/rxjs.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Français"><!--[--><!--]--> Français <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Select language"><span class="title">Langue</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Select language"><span class="title">Langue</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/angular-training/" class="" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a aria-current="page" href="/angular-training/fr/rxjs.html" class="router-link-active router-link-exact-active router-link-active" aria-label="Français"><!--[--><!--]--> Français <!--[--><!--]--></a></li><!--]--></ul></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/angular-training/fr/presentation.html" class="sidebar-item sidebar-heading" aria-label="Présentation d&#39;Angular"><!--[--><!--]--> Présentation d&#39;Angular <!--[--><!--]--></a><!----></li><li><a href="/angular-training/fr/typescript.html" class="sidebar-item sidebar-heading" aria-label="TypeScript"><!--[--><!--]--> TypeScript <!--[--><!--]--></a><!----></li><li><a href="/angular-training/fr/tooling.html" class="sidebar-item sidebar-heading" aria-label="Outillage"><!--[--><!--]--> Outillage <!--[--><!--]--></a><!----></li><li><a href="/angular-training/fr/first-steps.html" class="sidebar-item sidebar-heading" aria-label="Premiers pas"><!--[--><!--]--> Premiers pas <!--[--><!--]--></a><!----></li><li><a href="/angular-training/fr/template.html" class="sidebar-item sidebar-heading" aria-label="Dynamisez votre HTML"><!--[--><!--]--> Dynamisez votre HTML <!--[--><!--]--></a><!----></li><li><a href="/angular-training/fr/pipes.html" class="sidebar-item sidebar-heading" aria-label="Pipes"><!--[--><!--]--> Pipes <!--[--><!--]--></a><!----></li><li><a href="/angular-training/fr/components.html" class="sidebar-item sidebar-heading" aria-label="Composants"><!--[--><!--]--> Composants <!--[--><!--]--></a><!----></li><li><a href="/angular-training/fr/routing.html" class="sidebar-item sidebar-heading" aria-label="Routage"><!--[--><!--]--> Routage <!--[--><!--]--></a><!----></li><li><a href="/angular-training/fr/services.html" class="sidebar-item sidebar-heading" aria-label="Services"><!--[--><!--]--> Services <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/angular-training/fr/rxjs.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="RxJS"><!--[--><!--]--> RxJS <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/angular-training/fr/rxjs.html#l-observable" class="router-link-active router-link-exact-active sidebar-item" aria-label="L&#39;Observable"><!--[--><!--]--> L&#39;Observable <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/angular-training/fr/rxjs.html#creation-d-observable" class="router-link-active router-link-exact-active sidebar-item" aria-label="Création d&#39;Observable"><!--[--><!--]--> Création d&#39;Observable <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/angular-training/fr/rxjs.html#filtrage-et-mapping" class="router-link-active router-link-exact-active sidebar-item" aria-label="Filtrage et mapping"><!--[--><!--]--> Filtrage et mapping <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/angular-training/fr/rxjs.html#la-gestion-des-erreurs" class="router-link-active router-link-exact-active sidebar-item" aria-label="La gestion des erreurs"><!--[--><!--]--> La gestion des erreurs <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/angular-training/fr/rxjs.html#composition-de-flux" class="router-link-active router-link-exact-active sidebar-item" aria-label="Composition de flux"><!--[--><!--]--> Composition de flux <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/angular-training/fr/rxjs.html#unsubscribing" class="router-link-active router-link-exact-active sidebar-item" aria-label="Unsubscribing"><!--[--><!--]--> Unsubscribing <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/angular-training/fr/rxjs.html#pipe-async" class="router-link-active router-link-exact-active sidebar-item" aria-label="Pipe async"><!--[--><!--]--> Pipe async <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/angular-training/fr/rxjs.html#sommaire" class="router-link-active router-link-exact-active sidebar-item" aria-label="Sommaire"><!--[--><!--]--> Sommaire <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/angular-training/fr/rxjs.html#tp" class="router-link-active router-link-exact-active sidebar-item" aria-label="TP"><!--[--><!--]--> TP <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/angular-training/fr/rxjs.html#pour-aller-plus-loin" class="router-link-active router-link-exact-active sidebar-item" aria-label="Pour aller plus loin"><!--[--><!--]--> Pour aller plus loin <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/angular-training/fr/forms.html" class="sidebar-item sidebar-heading" aria-label="Formulaires"><!--[--><!--]--> Formulaires <!--[--><!--]--></a><!----></li><li><a href="/angular-training/fr/to-go-further.html" class="sidebar-item sidebar-heading" aria-label="Pour aller plus loin"><!--[--><!--]--> Pour aller plus loin <!--[--><!--]--></a><!----></li><li><a href="/angular-training/fr/ecosystem.html" class="sidebar-item sidebar-heading" aria-label="Écosystème d&#39;Angular"><!--[--><!--]--> Écosystème d&#39;Angular <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="rxjs" tabindex="-1"><a class="header-anchor" href="#rxjs" aria-hidden="true">#</a> RxJS</h1><p><a href="https://rxjs.dev/guide/overview" target="_blank" rel="noopener noreferrer">RxJS<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> est une librairie de programmation réactive utilisant les Observables. Cela facilite la composition de code asynchrone ou basé sur des callbacks. Elle fait partie de la collection <a href="http://reactivex.io/" target="_blank" rel="noopener noreferrer">ReactiveX<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> de librairies open source (RxJava, RxSwift, Rx.NET, RxScala...). Elles partagent toutes une API très similaire, ce qui signifie que le transfert des compétences Rx d&#39;un langage à un autre est très facile.</p><p>Le modèle ReactiveX d&#39;<code>Observable</code> vous permet de traiter des flux d&#39;événements asynchrones avec le même type d&#39;opérations simples et composables que vous utilisez pour des collections d&#39;éléments de données comme des tableaux, des opérations telles que <code>filter</code>, <code>map</code>, <code>flatMap</code>, <code> reduce</code> et bien d&#39;autres. Il vous libère d&#39;enchevêtrements de callbacks et rend ainsi votre code plus lisible et moins sujet aux bugs.</p><p>La librairie fournit le type <code>Observable</code> ainsi que des fonctions utilitaires pour :</p><ul><li>convertir le code existant lié aux opérations asynchrones en observables</li><li>itérer à travers les valeurs d&#39;un flux</li><li>mapper des valeurs à différents types</li><li>filtrer des flux</li><li>détecter les erreurs</li><li>composer plusieurs flux</li></ul><p>Ce chapitre n&#39;entrera pas en profondeur dans les concepts de Rx, vous pouvez vous référer à la documentation officielle à cet effet. Cependant, il illustrera des situations courantes rencontrées dans les applications Angular.</p><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>Ce chapitre est basé sur <a href="https://rxjs.dev/" target="_blank" rel="noopener noreferrer">RxJS v7<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>, la version utilisée par Angular 15.</p></div><h2 id="l-observable" tabindex="-1"><a class="header-anchor" href="#l-observable" aria-hidden="true">#</a> L&#39;Observable</h2><p>Le chapitre précédent vous a montré l&#39;utilisation de base des Observables. Voici ce que nous y avons vu :</p><ul><li>Les observables sont renvoyés par les méthodes du service <code>HttpClient</code>.</li><li>Les observables ne sont exécutés qu&#39;une fois subscribed</li><li>La méthode subscribe prend un objet constitué de trois callbacks (next, error and complete) en paramètre.</li></ul><p>Tout d&#39;abord, illustrons les deuxième et troisième points :</p><iframe height="500" width="100%" src="https://stackblitz.com/github/ocunidee/atpw-observable/tree/master?ctl=1&amp;embed=1&amp;file=src/app/app.component.ts&amp;hideExplorer=1&amp;hideNavigation=1&amp;title=Observable"></iframe><p>L&#39;<code>Observable</code> déclenche 3 notifications next suivies d&#39;une notification complete. Un Observable arrête d&#39;émettre des valeurs parce qu&#39;elles sont erronées (callback error) ou parce qu&#39;elles se terminent (callback complete). Les deux événements s&#39;excluent mutuellement.</p><h2 id="creation-d-observable" tabindex="-1"><a class="header-anchor" href="#creation-d-observable" aria-hidden="true">#</a> Création d&#39;Observable</h2><p>Dans une application Angular, vous aurez rarement à créer vous-même des observables. La plupart du temps, vous gérerez les flux que le framework a créés pour vous, tels que la gestion des résultats d&#39;appels http, l&#39;écoute d&#39;événements du routeur ou l&#39;écoute d&#39;événements de formulaire lors de l&#39;utilisation du <code>ReactiveFormsModule</code> (le nom du module révèle sa nature réactive). Cependant, vous pouvez rencontrer des situations où il peut vous incomber de créer un flux. Voici les principales façons dont cela pourrait se produire.</p><ul><li>interval (<a href="https://rxmarbles.com/#interval" target="_blank" rel="noopener noreferrer">marble<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> / <a href="https://rxjs.dev/api/index/function/interval" target="_blank" rel="noopener noreferrer">documentation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>)</li></ul><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token function-variable function">next</span><span class="token operator">:</span> n <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">It&#39;s been </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> seconds since subscribing!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>transformation de promesse (<a href="https://rxmarbles.com/#from" target="_blank" rel="noopener noreferrer">marble<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> / <a href="https://rxjs.dev/api/index/function/from" target="_blank" rel="noopener noreferrer">documentation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>)</li></ul><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> promise1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token builtin">Promise</span></span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;foo&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">from</span><span class="token punctuation">(</span>promise1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">next</span><span class="token operator">:</span> message <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The delayed message is &#39;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>message<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&#39;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">error</span><span class="token operator">:</span> error <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>promiseMessage <span class="token operator">=</span> <span class="token string">&#39;There\&#39;s been an error&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Completed&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>transformation d&#39;événement du navigateur (<a href="https://rxjs.dev/api/index/function/fromEvent" target="_blank" rel="noopener noreferrer">documentation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>)</li></ul><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token function">fromEvent</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> <span class="token string">&#39;click&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token function-variable function">next</span><span class="token operator">:</span> _ <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Clicked!&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Le Stackblitz suivant vous permet de jouer avec ces exemples :</p><iframe height="500" width="100%" src="https://stackblitz.com/github/ocunidee/atpw-observable-creation/tree/master?ctl=1&amp;embed=1&amp;file=src/app/app.component.ts&amp;hideExplorer=1&amp;title=Observable%20creation"></iframe><h2 id="filtrage-et-mapping" tabindex="-1"><a class="header-anchor" href="#filtrage-et-mapping" aria-hidden="true">#</a> Filtrage et mapping</h2><p>Semblable à la fonction bien connue <code>Array.prototype.map</code>, l&#39;opérateur <code>map</code> (<a href="https://rxmarbles.com/#map" target="_blank" rel="noopener noreferrer">marble<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> / <a href="https://rxjs.dev/api/operators/map" target="_blank" rel="noopener noreferrer">documentation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>) applique une projection à chaque valeur et émet cette projection dans l&#39;<code>Observable</code> de sortie.</p><p>Transformons l&#39;exemple précédent concernant l&#39;événement click sur le document pour qu&#39;il imprime les coordonnées du clic :</p><iframe height="500" width="100%" src="https://stackblitz.com/github/ocunidee/atpw-rx-operators/tree/master?ctl=1&amp;embed=1&amp;file=src/app/app.component.ts&amp;hideExplorer=1&amp;hideNavigation=1&amp;title=Mapping%20and%20Filtering"></iframe><div class="custom-container tip"><p class="custom-container-title">Pipe</p><p><code>pipe()</code> est une fonction utilisée pour composer des opérateurs tels que <code>map()</code>, <code>filter()</code>, <code>take()</code>... Les opérateurs sont appliqués au flux dans l&#39;ordre où ils sont passés à la fonction pipe</p></div><p>Similaire à la fonction <code>Array.prototype.filter</code>, l&#39;opérateur <code>filter</code> (<a href="https://rxmarbles.com/#filter" target="_blank" rel="noopener noreferrer">marble<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> / <a href="https://rxjs.dev/api/operators/filter" target="_blank" rel="noopener noreferrer">documentation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>) filtre les éléments émis par l&#39;Observable source en n&#39;émettant que ceux qui satisfont un prédicat spécifié.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token function">from</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">filter</span><span class="token punctuation">(</span>data <span class="token operator">=&gt;</span> data <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token function-variable function">next</span><span class="token operator">:</span> data <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Cet extrait affichera :</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token number">2</span>
<span class="token number">4</span>
<span class="token number">6</span>
<span class="token number">8</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Exercice : En utilisant le Stackblitz précédent sur l&#39;opération map, ne mettez à jour le message que pour les clics effectués dans les coordonnées comprises entre 0-100 sur les axes x et y.</strong></p><h2 id="la-gestion-des-erreurs" tabindex="-1"><a class="header-anchor" href="#la-gestion-des-erreurs" aria-hidden="true">#</a> La gestion des erreurs</h2><p>Comme vu précédemment, la méthode <code>subscribe</code> prend un en paramètre un object qui a une callback <code>error</code>. Lorsque l&#39;<code>Observable</code> émet en erreur, elle est exécutée à la place de la callback <code>next</code> et l&#39;<code>Observable</code> cesse d&#39;émettre.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">next</span><span class="token operator">:</span> users <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The following users exist in the system: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>users<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">error</span><span class="token operator">:</span> error <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">An error occurred: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Completed&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Ce comportement n&#39;est pas toujours celui souhaité. RxJS fournit un opérateur <code>catchError</code> (<a href="https://rxjs.dev/api/operators/catchError" target="_blank" rel="noopener noreferrer">documentation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>) pour traiter l&#39;erreur de manière &quot;silencieuse&quot;, ce qui signifie qu&#39;il s&#39;agit du callback <code>next</code> et non celui <code>error</code> qui est appelé.</p><p>Imaginons que vous vous attendiez à un tableau d&#39;utilisateurs du backend mais qu&#39;il vous renvoie une erreur HTTP 404, vous pouvez utiliser <code>catchError</code> pour renvoyer un tableau vide à la place, et continuer à générer une erreur pour d&#39;autres erreurs HTTP.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">getUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>
    <span class="token function">catchError</span><span class="token punctuation">(</span>error <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>error <span class="token keyword">as</span> HttpErrorResponse<span class="token punctuation">)</span><span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">of</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> <span class="token function">throwError</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">next</span><span class="token operator">:</span> users <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">The following users exist in the system: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>users<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">error</span><span class="token operator">:</span> error <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">An error occurred: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">complete</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Completed&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Question : Qu&#39;est-ce qui sera imprimé sur la console en cas d&#39;erreur 404 renvoyée par le backend ? En cas de 500 ?</strong></p><h2 id="composition-de-flux" tabindex="-1"><a class="header-anchor" href="#composition-de-flux" aria-hidden="true">#</a> Composition de flux</h2><p>Les flux peuvent être composés à de nombreuses fins. Pour étudier cette notion dans un environnement plus simple, nous ne l&#39;étudierons que dans le cadre d&#39;appels backend.</p><p>Il est assez courant de devoir enchaîner les appels backend. Par exemple, l&#39;utilisateur vient de modifier une ressource et vous souhaitez que votre page affiche ses détails mis à jour. Certains backends renvoient les détails de la ressource mise à jour dans le corps de la réponse à l&#39;appel d&#39;édition. Cependant, certains renvoient simplement une réponse HTTP 200 ou 204 sans corps. Cela signifie que l&#39;appel de modification et l&#39;appel de détail doivent être chaînés pour mettre à jour l&#39;interface utilisateur. RxJS fournit plusieurs opérateurs pour enchaîner les événements de manière déclarative. Nous utiliserons l&#39;opérateur <code>switchMap</code> (<a href="https://rxjs.dev/api/operators/switchMap" target="_blank" rel="noopener noreferrer">documentation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> / <a href="https://rxmarbles.com/#switchMap" target="_blank" rel="noopener noreferrer">marble<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>) dans ce cas. Vous pouvez l&#39;essayer dans le Stackblitz ci-dessous (cliquez n&#39;importe où sur l&#39;aperçu et voyez ce qu&#39;il se passe dans la console, cliquez à nouveau et voyez comment les choses changent dans la console).</p><iframe height="500" width="100%" src="https://stackblitz.com/edit/switchmap-training?ctl=1&amp;devtoolsheight=33&amp;embed=1&amp;file=index.ts&amp;hideExplorer=1&amp;hideNavigation=1&amp;title=SwitchMap%20exemple"></iframe><p><strong>Question : A partir de cet exemple, qu&#39;apprenez-vous sur le fonctionnement de switchMap ? (Regarder le diagramme marble peut aider)</strong> Adaptons l&#39;exemple ci-dessus au contexte des appels backend chaînés :</p><iframe height="500" width="100%" src="https://stackblitz.com/github/ocunidee/atpw-switchMap/tree/master?ctl=1&amp;embed=1&amp;file=src/app/app.component.ts&amp;hideExplorer=1&amp;hideNavigation=1&amp;title=SwitchMap%20exercise"></iframe><p>Un autre opérateur utile pour combiner les appels est <code>exhaustMap</code> (<a href="https://rxjs.dev/api/operators/exhaustMap" target="_blank" rel="noopener noreferrer">documentation<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>). Alors que <code>switchMap</code> annule l&#39;abonnement à l&#39;Observable projeté précédent, exhaustMap ignore les nouveaux événements tant que l&#39;Observable projeté précédent n&#39;est pas terminé.</p><div class="custom-container danger"><p class="custom-container-title">Ne pas imbriquer les subscribes</p><p>Un piège très courant avec RxJS est d&#39;imbriquer des subscribes. RxJS fournit de nombreux opérateurs afin que vous n&#39;ayez jamais à mélanger du code synchrone et asynchrone. Pourquoi ne pas les mélanger ?</p><ul><li>c&#39;est du code spaghetti qui devient difficile à lire et à maintenir car il ne bénéficie plus du caractère déclaratif de RxJS,</li><li>cela rend difficile de composer des observables,</li><li>cela provoque des fuites de mémoire.</li></ul><p>Le plus souvent, on le fait sans s&#39;en rendre compte. Par exemple, dans la callback next d&#39;un subscribe, vous appelez une méthode qui a un subscribe. C&#39;est de l&#39;imbrication de subscribes.</p><p>Exemple de ce que vous ne devriez PAS faire :</p><iframe height="500" width="100%" src="https://stackblitz.com/github/ocunidee/atpw-switchMap/tree/nested-subscribe?ctl=1&amp;embed=1&amp;file=src/app/app.component.ts&amp;hideExplorer=1&amp;hideNavigation=1&amp;title=Don&#39;t nest subscribes"></iframe></div><h2 id="unsubscribing" tabindex="-1"><a class="header-anchor" href="#unsubscribing" aria-hidden="true">#</a> Unsubscribing</h2><p>Pour le moment nous avons vu comment subscribe à un Observable. Pour éviter les fuites de mémoire avec les Observables de longue durée, vous devez vous unsubscribe de leur flux.</p><p>Réutilisons notre exemple de routage précédent pour illustrer comment les fuites mémoire peuvent se produire. Un Observable interval est créé dans la méthode ngOnInit du composant de détails du livre. <strong>Accédez aux détails d&#39;un livre et regardez la console. Puis quittez la page et revenez. Que se passe-t-il dans la console ? Qu&#39;est-ce que ça veut dire ?</strong></p><iframe height="500" width="100%" src="https://stackblitz.com/github/ocunidee/atpw-routing/tree/memory-leak?ctl=1&amp;embed=1&amp;file=src/app/book-details/book-details.component.ts&amp;hideExplorer=1&amp;hideNavigation=1&amp;title=Memory leak"></iframe><p>Quand unsubscribe ? Si vous n&#39;avez aucune certitude que l&#39;<code>Observable</code> s&#39;achèvera ou qu&#39;il produira une erreur, vous devez unsubscribe manuellement. Le <code>HttpClient</code> complète toujours l&#39;Observable qu&#39;il renvoie après avoir reçu une réponse. Donc, théoriquement, si vous ne rencontrez que des Observables du <code>HttpClient</code>, vous n&#39;avez pas à unsubscribe. Dans les autres cas, <strong>soyez prudent et unsubscribe</strong>.</p><p>Comment unsubscribe ? En utilisant l&#39;opérateur <code>takeUntilDestroyed</code> et en lui passant un <code>destroyRef</code>.</p><p>Corrigons la fuite de mémoire de l&#39;exemple précédent.</p><iframe height="500" width="100%" src="https://stackblitz.com/github/ocunidee/atpw-routing/tree/memory-leak-fix?ctl=1&amp;embed=1&amp;file=src/app/book-details/book-details.component.ts&amp;hideExplorer=1&amp;hideNavigation=1&amp;title=takeUntilDestroyed"></iframe><h2 id="pipe-async" tabindex="-1"><a class="header-anchor" href="#pipe-async" aria-hidden="true">#</a> Pipe async</h2><p>Invoquer la méthode subscribe sur un <code>Observable</code> et enregistrer la valeur dans une propriété du composant n&#39;est pas le seul moyen d&#39;afficher les valeurs de l&#39;<code>Observable</code>. Angular fournit un pipe à appliquer directement sur un <code>Observable</code>.</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Component class</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">Component template</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppComponent</span> <span class="token punctuation">{</span>
  counter<span class="token operator">:</span> Observable<span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{counter | async}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Pour les objets, une syntaxe alternative existe pour éviter d&#39;utiliser de manière répétitive le pipe async pour accéder à chaque champ. Sachant que chaque pipe <code>async</code> crée une souscription et trigger de nouveau l&#39;exécution de l&#39;<code>Observable</code>, c&#39;est à éviter :</p><div class="code-group"><div class="code-group__nav"><ul class="code-group__ul"><li class="code-group__li"><button class="code-group__nav-tab code-group__nav-tab-active" ariapressed="true" ariaexpanded="true">Component template</button></li><li class="code-group__li"><button class="code-group__nav-tab" ariapressed="false" ariaexpanded="false">Component class</button></li></ul></div><!--[--><div class="code-group-item" aria-selected="false"><!--[--><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token comment">&lt;!-- A EVITER --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{(user | async)?.firstName}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{(user | async)?.lastName}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{(user | async)?.age}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- METHODE À PREFEREE --&gt;</span>
@if (user | async as user) {
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{user.firstName}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{user.lastName}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{user.age}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
}

<span class="token comment">&lt;!-- EN UTILISANT LA SYNTAXE @let --&gt;</span>
@let unwrappedUser = user | async;
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{unwrappedUser?.firstName}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{unwrappedUser?.lastName}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{unwrappedUser?.age}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><div class="code-group-item" aria-selected="false"><!--[--><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token operator">:</span> <span class="token string">&#39;app-root&#39;</span><span class="token punctuation">,</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>AsyncPipe<span class="token punctuation">]</span><span class="token punctuation">,</span>
  templateUrl<span class="token operator">:</span> <span class="token string">&#39;./app.component.html&#39;</span><span class="token punctuation">,</span>
  styleUrl<span class="token operator">:</span> <span class="token string">&#39;./app.component.scss&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppComponent</span> <span class="token punctuation">{</span>
  user<span class="token operator">:</span> Observable<span class="token operator">&lt;</span>User<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token function">interval</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">map</span><span class="token punctuation">(</span>_ <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">&#39;John&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Snow&#39;</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>
    <span class="token keyword">public</span> firstName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    <span class="token keyword">public</span> lastName<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    <span class="token keyword">public</span> age<span class="token operator">:</span> <span class="token builtin">number</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="highlight-lines"><br><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><!--]--></div><!--]--></div><p>Aucun subscribe n&#39;étant effectué, il n&#39;est pas nécessaire d&#39;unsubscribe. Le pipe async s&#39;en charge pour nous.</p><h2 id="sommaire" tabindex="-1"><a class="header-anchor" href="#sommaire" aria-hidden="true">#</a> Sommaire</h2><div class="custom-container tip"><p class="custom-container-title">Points clés à retenir</p><ul><li>Unsubscribe ou utilisez le pipe async</li><li>N&#39;imbriquez jamais les subscribes, trouvez plutôt les bons opérateurs</li></ul></div><p>Voici un tableau des opérateurs les plus couramment utilisés.</p><table><thead><tr><th>Zone</th><th>Opérateurs</th></tr></thead><tbody><tr><td>Création</td><td>from, of, fromEvent, interval</td></tr><tr><td>Filtrage</td><td>filter, takeUntil, take, distinctUntilChanged</td></tr><tr><td>Transformation</td><td>switchMap, exhaustMap, concatMap, mergeMap, map</td></tr><tr><td>Combination</td><td>combineLatest, concat, merge, startWith, withLatestFrom, zip</td></tr><tr><td>Utilitaire</td><td>tap, finalize, catchError</td></tr></tbody></table><p>Il existe également deux constantes <code>Observable</code> : <code>NEVER</code> (n&#39;émet ni valeurs ni erreurs ni la notification complete) et <code>EMPTY</code> (n&#39;émet aucun élément et émet immédiatement une notification complete). <code>EMPTY</code> est très utile comme valeur de retour de l&#39;opérateur <code>catchError</code>.</p><p>Pour vous aider à décider quel opérateur correspond à votre cas d&#39;utilisation, la documentation RxJS fournit un <a href="https://rxjs.dev/operator-decision-tree" target="_blank" rel="noopener noreferrer">arbre de décision d&#39;opérateur<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>. Cela aide également à découvrir les nombreux opérateurs fournis par RxJS.</p><h2 id="tp" tabindex="-1"><a class="header-anchor" href="#tp" aria-hidden="true">#</a> TP</h2><ol><li>Dans le fichier <code>film-search.component.ts</code>, arrêtez de subscribe à la réponse de recherche et utilisez plutôt un pipe async dans le template. N&#39;oubliez pas d&#39;ajouter l&#39;<code>AsyncPipe</code> au tableau <code>imports</code>.</li><li>Même si cela n&#39;est pas strictement nécessaire dans ces cas, vous pouvez vous unsubscribe des appels à login et register dans le <code>LoginFormComponent</code> en utilisant la technique <code>takeUntilDestroyed</code>.</li></ol><h2 id="pour-aller-plus-loin" tabindex="-1"><a class="header-anchor" href="#pour-aller-plus-loin" aria-hidden="true">#</a> Pour aller plus loin</h2><p>Angular fournit des fonctions pour inter opérer entre les Signaux et les Observables. La documentation se trouve <a href="https://angular.dev/ecosystem/rxjs-interop" target="_blank" rel="noopener noreferrer">ici<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/angular-training/fr/services.html" class="" aria-label="Services"><!--[--><!--]--> Services <!--[--><!--]--></a></span><span class="next"><a href="/angular-training/fr/forms.html" class="" aria-label="Formulaires"><!--[--><!--]--> Formulaires <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/angular-training/assets/js/v-7ba3cfc0.c87d4cf7.js" defer></script><script src="/angular-training/assets/js/runtime~app.a825557b.js" defer></script><script src="/angular-training/assets/js/966.6bc1d20f.js" defer></script><script src="/angular-training/assets/js/app.2146f142.js" defer></script>
  </body>
</html>
